{"version":3,"sources":["app.min.js"],"names":["NoahsApp","angular","module","config","$stateProvider","$urlRouterProvider","otherwise","state","url","templateUrl","controller","service","$http","this","requestTifs","apikey","query","method","data","then","result","console","log","pumps","fakePumps","id","name","latitude","longitude","createPumpFromTxt","txt","pump","parts","split","i","length","trim","substring","indexOf","lastIndexOf","parseFloat","generatePumpsFromTxt","splitted","newPump","isNaN","push","readPumpsFromTxt","context","rawFile","XMLHttpRequest","open","onreadystatechange","readyState","status","allText","responseText","send","fetchPumpData","err","message","getPump","parseInt","$scope","FmiAPIService","apierror","api_field","query_field","fmilink","tiflinks","sendRequest","generateMap","index","checkIfErrorUndefined","MapService","PumpService","initMap","mymap","conversion","a","b","firstProjection","secondProjection","coordinates","proj4","crs","L","Proj","CRS","TMS","resolutions","Map","continuousWorld","worldCopyJump","zoomControl","layers","tileUrl","attrib","tilelayer","TileLayer","maxZoom","minZoom","tileSize","tms","attribution","subdomains","tutkakuvaUrl","tutkakuvaBounds","imageOverlay","addTo","addLayer","setView","oikeaTuppi","marker","bindPopup","openPopup","vasenYla","oikeaAla","vasenAla","ikaalinen","vimpeli","utajarvi","petajavesi","kuopio","kesalahti","joku2","joku","jokuryhma","layerGroup","circle","color","fillColor","fillOpacity","createMarker","jokuUus","createPumpMarkers","pumpGroup","$stateParams","generatePumps","directive"],"mappings":"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","file":"app.min.js","sourcesContent":["var NoahsApp = angular.module(\"NoahsApp\", [\"ui.router\"]);\n\nNoahsApp.config([\"$stateProvider\", \"$urlRouterProvider\", function($stateProvider, $urlRouterProvider) {\r\n  $urlRouterProvider.otherwise(\"/\");\r\n\r\n  $stateProvider\r\n    .state(\"main\", {\r\n      url: \"/\",\r\n      templateUrl: \"app/components/main/main.html\",\r\n      controller: \"MainController\",\r\n    })\r\n    .state(\"map\", {\r\n      url: \"/map\",\r\n      templateUrl: \"app/components/map/map.html\",\r\n      controller: \"MapController\",\r\n    })\r\n    .state(\"pump\", {\r\n      url: \"/pump/:id\",\r\n      templateUrl: \"app/components/pump/pump.html\",\r\n      controller: \"PumpController\",\r\n    })\r\n}])\r\n\nNoahsApp.service(\"FmiAPIService\", [\"$http\", function($http) {\r\n  this.requestTifs = function(apikey, query) {\r\n    var config = {\r\n      method: \"POST\",\r\n      url: \"https://noahs-app-backend.herokuapp.com/radar\",\r\n      data: {\r\n        apikey: apikey,\r\n        query: query,\r\n      }\r\n    }\r\n    return $http(config)\r\n      .then(function(result) {\r\n        console.log(result);\r\n        return result.data;\r\n      })\r\n  }\r\n}]);\r\n\nNoahsApp.service(\"PumpService\", [\"$http\", function($http) {\r\n  this.pumps = [];\r\n  this.fakePumps = [{\r\n    id: 1,\r\n    name: \"pumppu lol\",\r\n    latitude: 59,\r\n    longitude: 25,\r\n  }, {\r\n    id: 2,\r\n    name: \"toka pumppu\",\r\n    latitude: 59.5,\r\n    longitude: 25,\r\n  }, {\r\n    id: 3,\r\n    name: \"kolmas pumppu\",\r\n    latitude: 60,\r\n    longitude: 25,\r\n  }]\r\n  // creates pump object from parsed array from the txt-file\r\n  // e.g. [\"u'3025'\", \"u'Eilantie'\", \"60.32972222222222\", \"25.113277777777782)\"]\r\n  this.createPumpFromTxt = function(txt) {\r\n    var pump = {};\r\n    var parts = txt.split(\",\");\r\n    for (var i = 0; i < parts.length; i++) {\r\n      parts[i] = parts[i].trim();\r\n      if (i===0) {\r\n        // id : \"u'3025'\"\r\n        pump.id = parts[i].substring(parts[i].indexOf(\"'\")+1, parts[i].lastIndexOf(\"'\"));\r\n      } else if (i===1) {\r\n        // name : \"u'Eilantie'\"\r\n        pump.name = parts[i].substring(parts[i].indexOf(\"'\")+1, parts[i].lastIndexOf(\"'\"));\r\n      } else if (i===2) {\r\n        pump.latitude = parseFloat(parts[i]);\r\n      } else if (i===3) {\r\n        pump.longitude = parseFloat(parts[i]);\r\n      }\r\n    }\r\n    // console.log(pump);\r\n    return pump;\r\n  }\r\n  this.generatePumpsFromTxt = function(txt) {\r\n    var pumps = [];\r\n    var splitted = txt.split(\"(\");\r\n    for(var i = 0; i < splitted.length; i++) {\r\n      var newPump = this.createPumpFromTxt(splitted[i]);\r\n      if (!isNaN(newPump.latitude) && !isNaN(newPump.longitude)) {\r\n        pumps.push(newPump);\r\n      }\r\n    }\r\n    // console.log(pumps);\r\n    // console.log(pumps.length);\r\n    return pumps;\r\n  }\r\n  this.readPumpsFromTxt = function() {\r\n    this.pumps = this.fakePumps;\r\n    var context = this;\r\n    var rawFile = new XMLHttpRequest();\r\n    rawFile.open(\"GET\", \"/data/pumps.txt\", false);\r\n    rawFile.onreadystatechange = function() {\r\n      if (rawFile.readyState === 4) {\r\n        if (rawFile.status === 200 || rawFile.status == 0) {\r\n          var allText = rawFile.responseText;\r\n          context.pumps = context.generatePumpsFromTxt(allText);\r\n        }\r\n      }\r\n    }\r\n    rawFile.send(null);\r\n  }\r\n  this.fetchPumpData = function() {\r\n    var config = {\r\n      method: \"POST\",\r\n      url: \"http://10.144.72.11\",\r\n      data: {\r\n        apikey: apikey,\r\n        query: query,\r\n      }\r\n    }\r\n    return $http(config)\r\n      .then(function(result) {\r\n        console.log(result);\r\n        this.pumps = result.data;\r\n        return result.data;\r\n      })\r\n      .catch(function(err) {\r\n        console.log(\"Calling API produced an error:\");\r\n        console.log(err.data.message);\r\n        return [];\r\n      })\r\n  }\r\n  this.getPump = function(id) {\r\n    console.log(\" id on \" + id);\r\n    for (var i = 0; i < this.pumps.length; i++) {\r\n      // console.log(this.pumps[i].id)\r\n      if (this.pumps[i].id === id || parseInt(this.pumps[i].id) === id) {\r\n        console.log(this.pumps[i]);\r\n        return this.pumps[i];\r\n      }\r\n    }\r\n    console.log(\"not found\");\r\n    return \"no pump found\";\r\n  }\r\n  this.readPumpsFromTxt();\r\n}])\r\n\nNoahsApp.controller(\"MainController\", [\"$scope\", \"FmiAPIService\", function($scope, FmiAPIService) {\r\n  $scope.apierror = {};\r\n  $scope.api_field = \"5c2fc68e-d165-45f5-af8f-ce9fc0b36e68\";\r\n  $scope.query_field = \"/wfs?request=GetFeature&storedquery_id=fmi::radar::composite::rr\";\r\n  $scope.fmilink = \"\";\r\n  $scope.tiflinks = [];\r\n\r\n  $scope.sendRequest = function() {\r\n    FmiAPIService\r\n      .requestTifs($scope.api_field, $scope.query_field)\r\n      .then(function(result) {\r\n        console.log(\"Got result\");\r\n        console.log(result);\r\n        $scope.fmilink = result.fmilink;\r\n        $scope.tiflinks = result.tiflinks;\r\n        $scope.apierror = {};\r\n      })\r\n      .catch(function(err) {\r\n        console.log(err.data.message);\r\n        $scope.apierror = err.data;\r\n        console.log($scope.apierror);\r\n      })\r\n  }\r\n\r\n  $scope.generateMap = function(index) {\r\n    // var picture = $scope.tiflinks[index];\r\n    // PictureService\r\n    //   .requestRadarPicture(picture)\r\n    //   .then(function(result) {\r\n    //\r\n    //   })\r\n  }\r\n\r\n  $scope.checkIfErrorUndefined = function() {\r\n    return typeof $scope.apierror.message === \"undefined\";\r\n  }\r\n}])\r\n\nNoahsApp.controller(\"MapController\", [\"$scope\", \"MapService\", \"PumpService\", function($scope, MapService, PumpService) {\r\n  MapService.pumps = PumpService.pumps;\r\n  MapService.initMap();\r\n}])\r\n\nNoahsApp.service(\"MapService\", function() {\r\n  this.mymap = \"\";\r\n  this.pumps = [{\r\n    id: 1,\r\n    name: \"pumppu lol\",\r\n    latitude: 59,\r\n    longitude: 25,\r\n  }, {\r\n    id: 2,\r\n    name: \"toka pumppu\",\r\n    latitude: 59.5,\r\n    longitude: 25,\r\n  }, {\r\n    id: 3,\r\n    name: \"kolmas pumppu\",\r\n    latitude: 60,\r\n    longitude: 25,\r\n  }]\r\n\r\n this.conversion = function(a, b) {\r\n   var firstProjection = \"+proj=utm +zone=35 +ellps=GRS80 +units=m +no_defs +towgs84=0,0,0,-0,-0,-0,0\";\r\n   var secondProjection = \"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs\";\r\n   var coordinates = proj4(firstProjection, secondProjection, [a, b]);\r\n   return coordinates;\r\n }\r\n\r\n  this.initMap = function() {\r\n    var crs = new L.Proj.CRS.TMS('EPSG:3067',\r\n      '+proj=utm +zone=35 +ellps=GRS80 +units=m +towgs84=0,0,0,-0,-0,-0,0 +no_defs', [-548576.0, 6291456.0, 1548576.0, 8388608], {\r\n        resolutions: [\r\n          8192,\r\n          4096,\r\n          2048,\r\n          1024,\r\n          512,\r\n          256,\r\n          128,\r\n          64,\r\n          32,\r\n          16,\r\n          8,\r\n          4,\r\n          2,\r\n          1,\r\n          0.5,\r\n          0.25\r\n        ]\r\n      });\r\n\r\n    this.mymap = new L.Map('map', {\r\n      crs: crs,\r\n      continuousWorld: true,\r\n      worldCopyJump: false,\r\n      zoomControl: true,\r\n      layers: []\r\n    });\r\n\r\n    var tileUrl = 'https://{s}.kapsi.fi/mapcache/peruskartta_3067/{z}/{x}/{y}.png';\r\n    var attrib = '&copy; Karttamateriaali <a href=\"http://www.maanmittauslaitos.fi/avoindata\">Maanmittauslaitos</a>';\r\n    var tilelayer = new L.Proj.TileLayer.TMS(tileUrl, crs, {\r\n        maxZoom: 14,\r\n        minZoom: 0,\r\n        tileSize: 256,\r\n        tms: false,\r\n        continuousWorld: true,\r\n        attribution: attrib,\r\n        subdomains: ['tile1', 'tile2']\r\n      });\r\n\r\n\r\n    // tutkan koordinatit parsittu fmi-xml:stä gml-coordinates nimellä\r\n    // -118331.366 7907751.537 875567.732 7907751.537 875567.732 6335621.167 -118331.366 6335621.167 -118331.366 7907751.537\r\n    // console.log(conversion(7907751.537, -118331.366));\r\n    // console.log(conversion(-118331.366, 7907751.537));\r\n    // console.log(conversion(875567.732, 7907751.537));\r\n    // console.log(conversion(875567.732, 6335621.167));\r\n    // console.log(conversion(-118331.366, 6335621.167));\r\n    // console.log(conversion(-118331.366, 7907751.537));\r\n    // var tutkakuvaBounds = [\r\n      // [33.18909488231688, 57.01073316247846],  // oikea yläkulma\r\n      // [10.2139235307523, 70.49988067141419], // vasen yläkulma\r\n      // [37.37170826858529, 70.9830591433417], // vasen\r\n      // [16.86739870411734, 56.75131897332151],\r\n      // [10.2139235307523, 70.49988067141419]\r\n    // ];\r\n\r\n    var tutkakuvaUrl = '/img/sade-tutka.png';\r\n    // var tutkakuvaBounds = [\r\n    //   [70.49988067141419, 10.2139235307523],\r\n    //   [57.01073316247846, 33.18909488231688]\r\n    // ];\r\n\r\n    var tutkakuvaBounds = [\r\n      // [7907751.537, -118331.366],\r\n      // [875567.732, 6335621.167]\r\n      [57.01073316247846, 35.67170826858529],\r\n      [70.49988067141419, 8.5139235307523],\r\n    ];\r\n\r\n    L.imageOverlay(tutkakuvaUrl, tutkakuvaBounds).addTo(this.mymap);\r\n\r\n    this.mymap.addLayer(tilelayer);\r\n    this.mymap.setView([65.01275, 25.46815], 2);\r\n\r\n    function addMarker(a, b) {\r\n      var coord = conversion(a, b);\r\n      var markern = L.marker([coord[1], coord[0]]).addTo(this.mymap);\r\n    }\r\n\r\n    var oikeaTuppi = L.marker([10.2139235307523, 70.49988067141419]).bindPopup(\"Oikea tuppi\").openPopup();\r\n    // var oikeaYla = L.marker([70.49988067141419, 10.2139235307523]).bindPopup(\"Oikea yläkulma\").openPopup();\r\n    var vasenYla = L.marker([70.49988067141419, 37.37170826858529]).bindPopup(\"Vasen yläkulma\").openPopup();\r\n    var oikeaAla = L.marker([57.01073316247846, 10.2139235307523]).bindPopup(\"Oikea alakulma\").openPopup();\r\n    var vasenAla = L.marker([57.01073316247846, 37.37170826858529]).bindPopup(\"Vasen alakulma\").openPopup();\r\n\r\n    // radars from http://ilmatieteenlaitos.fi/suomen-tutkaverkko\r\n    var ikaalinen = L.marker([61.7673, 23.0764]).bindPopup(\"Ikaalisen tutka-asema\").openPopup();\r\n    var vimpeli = L.marker([63.1048, 23.8209]).bindPopup(\"Vimpelin tutka-asema\").openPopup();\r\n    var utajarvi = L.marker([64.7749, 26.3189]).bindPopup(\"Utajärven tutka-asema\").openPopup();\r\n    var petajavesi = L.marker([62.3045, 25.4401]).bindPopup(\"Petäjäveden tutka-asema\").openPopup();\r\n    var kuopio = L.marker([62.8626, 27.3815]).bindPopup(\"Kuopion tutka-asema\").openPopup();\r\n    var kesalahti = L.marker([61.9070, 29.7977]).bindPopup(\"Kiteen tutka-asema\").openPopup();\r\n\r\n    var joku2 = L.marker([65.01275, 25.56815]).bindPopup(\"<a target='_blank' href='https://google.com'>I am a popup.</a>\").openPopup();\r\n    var joku = L.marker([65.01275, 25.46815]).bindPopup(\"<a target='_blank' href='https://google.com'>I am a popup.</a>\").openPopup();\r\n\r\n    var jokuryhma = L.layerGroup([oikeaTuppi, vasenYla, oikeaAla, vasenAla, ikaalinen, vimpeli, utajarvi, petajavesi, kuopio, kesalahti, joku2, joku]);\r\n\r\n    var circle = L.circle([65.01275, 25.46815], 500, {\r\n      color: 'red',\r\n      fillColor: '#f03',\r\n      fillOpacity: 0.5\r\n    }).addTo(this.mymap);\r\n\r\n    jokuryhma.addTo(this.mymap);\r\n    for(var i = 0; i < this.pumps.length; i++) {\r\n      var pump = this.pumps[i];\r\n      var newPump = L.marker([pump.latitude, pump.longitude])\r\n        .bindPopup(\"<a target='_blank' href='#/pump/\"+ pump.id +\"'>Pumppu \" + pump.id + \"</a>\").openPopup();\r\n      newPump.addTo(this.mymap);\r\n    }\r\n  }\r\n  this.createMarker = function() {\r\n    var jokuUus = L.marker([64.01275, 25.46815]).bindPopup(\"<a href=''>JOKU UUS<\").openPopup();\r\n    var jokuUusRyh = L.layerGroup([jokuUus]);\r\n    jokuUus.addTo(this.mymap);\r\n  }\r\n  this.createPumpMarkers = function(pumps) {\r\n    var pumpGroup = [];\r\n    for (var i = 0; i < pumps.length; i++) {\r\n      var pump = pumps[i];\r\n      var newPump = L.marker([pump.latitude, pump.longitude])\r\n        .bindPopup(\"Pumppu \" + pump.id).openPopup();\r\n      pumpGroup.push(newPump);\r\n      newPump.addTo(this.mymap);\r\n    }\r\n    console.log(pumpGroup);\r\n    // var pumpGroup = L.layerGroup(pumpGroup);\r\n    // pumpGroup.addTo(this.mymap);\r\n  }\r\n})\r\n\nNoahsApp.controller(\"PumpController\", [\"$scope\", \"$stateParams\", \"MapService\", \"PumpService\", function($scope, $stateParams, MapService, PumpService) {\r\n  $scope.id = $stateParams.id;\r\n  $scope.pump = PumpService.getPump(parseInt($scope.id));\r\n  // console.log(PumpService.pumps);\r\n  $scope.generatePumps = function() {\r\n    // MapService.pumps = \r\n    // MapService.createMarker();\r\n    // MapService.createPumpMarkers(PumpService.pumps);\r\n  }\r\n}])\r\n\nNoahsApp.directive(\"navDirective\", function() {\r\n  return {\r\n    templateUrl: \"app/components/nav/nav.html\",    \r\n  }\r\n})\r\n"]}